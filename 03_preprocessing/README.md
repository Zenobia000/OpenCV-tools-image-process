# éšæ®µä¸‰ï¼šå‰è™•ç†æŠ€è¡“æ¨¡çµ„ (Stage 3: Preprocessing Techniques)

## ğŸ“‹ æ¨¡çµ„æ¦‚è¦½

æœ¬éšæ®µæ¶µè“‹å½±åƒå‰è™•ç†çš„æ ¸å¿ƒæŠ€è¡“ï¼Œç‚ºå¾ŒçºŒç‰¹å¾µæª¢æ¸¬èˆ‡æ©Ÿå™¨å­¸ç¿’å¥ å®šåŸºç¤ã€‚

**WBSç·¨è™Ÿ**: 3.x.x
**å­¸ç¿’æ™‚é•·**: 8-10å°æ™‚
**é›£åº¦ç­‰ç´š**: â­â­â­ (ä¸­ç´š)

---

## ğŸ“š æ¨¡çµ„åˆ—è¡¨

### 3.1 æ¿¾æ³¢èˆ‡å¹³æ»‘ (Filtering & Smoothing)

#### [3.1.1 æ¿¾æ³¢èˆ‡å¹³æ»‘](./3.1.1_filtering_smoothing.ipynb) âœ…
**å…§å®¹**:
- é«˜æ–¯æ¿¾æ³¢å™¨ (Gaussian Filter)
- å¹³å‡æ¿¾æ³¢å™¨ (Mean Filter)
- ä¸­å€¼æ¿¾æ³¢å™¨ (Median Filter)
- é›™é‚Šæ¿¾æ³¢å™¨ (Bilateral Filter)
- è‡ªå®šç¾©å·ç©æ ¸ (Custom Kernels)

**å­¸ç¿’ç›®æ¨™**: ç†è§£ä¸åŒæ¿¾æ³¢å™¨çš„ç‰¹æ€§èˆ‡æ‡‰ç”¨å ´æ™¯

---

#### [3.1.2 å½¢æ…‹å­¸æ“ä½œ](./3.1.2_morphological_ops.ipynb) âœ…
**å…§å®¹**:
- ä¾µè• (Erosion)
- è†¨è„¹ (Dilation)
- é–‹é‹ç®—/é–‰é‹ç®— (Opening/Closing)
- å½¢æ…‹å­¸æ¢¯åº¦ (Morphological Gradient)
- é ‚å¸½/é»‘å¸½è®Šæ› (Top-hat/Black-hat)
- è‡ªå®šç¾©çµæ§‹å…ƒç´  (Custom Kernels)

**å­¸ç¿’ç›®æ¨™**: æŒæ¡å½¢æ…‹å­¸æ“ä½œåœ¨å½±åƒè™•ç†ä¸­çš„æ‡‰ç”¨

---

#### [3.1.3 é‚Šç·£æª¢æ¸¬](./3.1.3_edge_detection.ipynb) âœ…
**å…§å®¹**:
- Canny é‚Šç·£æª¢æ¸¬
- Sobel ç®—å­
- Scharr æ¿¾æ³¢å™¨
- Laplacian ç®—å­
- é‚Šç·£æª¢æ¸¬åƒæ•¸èª¿æ•´
- DoG (Difference of Gaussian)
- è¼ªå»“æª¢æ¸¬èˆ‡åˆ†æ (findContours)
- é‚Šç•ŒçŸ©å½¢èˆ‡çŸ©è¨ˆç®—
- è¼ªå»“é¢ç©èˆ‡å‘¨é•·

**å­¸ç¿’ç›®æ¨™**: ç²¾é€šå„ç¨®é‚Šç·£æª¢æ¸¬ç®—æ³•åŠå…¶åƒæ•¸èª¿æ•´

---

### 3.2 å½±åƒå¢å¼·æŠ€è¡“ (Image Enhancement)

#### [3.2.1 ç›´æ–¹åœ–è™•ç†](./3.2.1_histogram_processing.ipynb) âœ…
**å…§å®¹**:
- ç›´æ–¹åœ–è¨ˆç®—èˆ‡é¡¯ç¤º
- ç›´æ–¹åœ–å‡åŒ– (Histogram Equalization)
- å°æ¯”åº¦é™åˆ¶è‡ªé©æ‡‰ç›´æ–¹åœ–å‡åŒ– (CLAHE)
- BGRä¸‰é€šé“è™•ç†
- ç°éšæ‹‰ä¼¸ (Contrast Stretching)

**å­¸ç¿’ç›®æ¨™**: ä½¿ç”¨ç›´æ–¹åœ–æŠ€è¡“æ”¹å–„å½±åƒå“è³ª

---

#### [3.2.2 å™ªè²è™•ç†](./3.2.2_noise_reduction.ipynb) âœ…
**å…§å®¹**:
- å™ªè²é¡å‹è­˜åˆ¥ (é«˜æ–¯/æ¤’é¹½/æ–‘é»/é€±æœŸæ€§)
- ç©ºé–“åŸŸé™å™ª (Mean/Gaussian/Median/Bilateral)
- é€²éšé™å™ª (NLMéå±€éƒ¨å‡å€¼)
- å½¢æ…‹å­¸é™å™ª
- æ•ˆèƒ½åŸºæº–æ¸¬è©¦
- è‡ªé©æ‡‰é™å™ªæ¼”ç®—æ³•
- é™å™ªæ–¹æ³•é¸æ“‡æ±ºç­–æ¨¹

**å­¸ç¿’ç›®æ¨™**: æŒæ¡å¤šç¨®é™å™ªæŠ€è¡“ä¸¦èƒ½æ ¹æ“šå ´æ™¯é¸æ“‡

---

#### [3.2.3 é–¾å€¼è™•ç†](./3.2.3_thresholding.ipynb) âœ…
**å…§å®¹**:
- Threshold äºŒå€¼åŒ–è™•ç†
- è‡ªé©æ‡‰é–¾å€¼ (Adaptive Threshold)
- Otsu è‡ªå‹•é–¾å€¼
- å¤šç¨®é–¾å€¼é¡å‹æ¯”è¼ƒ

**å­¸ç¿’ç›®æ¨™**: ç†è§£äºŒå€¼åŒ–æŠ€è¡“åœ¨å½±åƒåˆ†å‰²ä¸­çš„æ‡‰ç”¨

---

## ğŸ¯ å­¸ç¿’è·¯å¾‘

```
æ¨è–¦å­¸ç¿’é †åº:

1. æ¿¾æ³¢èˆ‡å¹³æ»‘ (3.1.1)     â† åŸºç¤
   â†“
2. å½¢æ…‹å­¸æ“ä½œ (3.1.2)     â† çµæ§‹è™•ç†
   â†“
3. é–¾å€¼è™•ç† (3.2.3)       â† äºŒå€¼åŒ–
   â†“
4. é‚Šç·£æª¢æ¸¬ (3.1.3)       â† ç‰¹å¾µæå–
   â†“
5. ç›´æ–¹åœ–è™•ç† (3.2.1)     â† å½±åƒå¢å¼·
   â†“
6. å™ªè²è™•ç† (3.2.2)       â† å“è³ªæ”¹å–„
```

---

## ğŸ“Š éšæ®µå®Œæˆåº¦

| æ¨¡çµ„ç·¨è™Ÿ | æ¨¡çµ„åç¨± | ç‹€æ…‹ | æª”æ¡ˆå¤§å° | Cellsæ•¸ |
|---------|---------|------|----------|---------|
| 3.1.1 | æ¿¾æ³¢èˆ‡å¹³æ»‘ | âœ… | 86KB | - |
| 3.1.2 | å½¢æ…‹å­¸æ“ä½œ | âœ… | 21KB | 31 |
| 3.1.3 | é‚Šç·£æª¢æ¸¬ | âœ… | 216KB | 66 |
| 3.2.1 | ç›´æ–¹åœ–è™•ç† | âœ… | 15KB | 17 |
| 3.2.2 | å™ªè²è™•ç† | âœ… | 45KB | 31 |
| 3.2.3 | é–¾å€¼è™•ç† | âœ… | 85KB | - |

**ç¸½è¨ˆ**: 6/6 æ¨¡çµ„å®Œæˆ = **100%** âœ…

---

## ğŸ”§ æŠ€è¡“æ£§

### æ ¸å¿ƒå‡½æ•¸

#### æ¿¾æ³¢
```python
cv2.GaussianBlur()      # é«˜æ–¯æ¿¾æ³¢
cv2.blur()              # å¹³å‡æ¿¾æ³¢
cv2.medianBlur()        # ä¸­å€¼æ¿¾æ³¢
cv2.bilateralFilter()   # é›™é‚Šæ¿¾æ³¢
cv2.filter2D()          # è‡ªå®šç¾©å·ç©
```

#### å½¢æ…‹å­¸
```python
cv2.erode()             # ä¾µè•
cv2.dilate()            # è†¨è„¹
cv2.morphologyEx()      # å½¢æ…‹å­¸æ“ä½œ
cv2.getStructuringElement()  # çµæ§‹å…ƒç´ 
```

#### é‚Šç·£æª¢æ¸¬
```python
cv2.Canny()             # Cannyé‚Šç·£æª¢æ¸¬
cv2.Sobel()             # Sobelç®—å­
cv2.Scharr()            # Scharræ¿¾æ³¢å™¨
cv2.Laplacian()         # Laplacianç®—å­
cv2.findContours()      # è¼ªå»“æª¢æ¸¬
```

#### ç›´æ–¹åœ–
```python
cv2.calcHist()          # è¨ˆç®—ç›´æ–¹åœ–
cv2.equalizeHist()      # ç›´æ–¹åœ–å‡åŒ–
cv2.createCLAHE()       # CLAHE
```

#### é™å™ª
```python
cv2.fastNlMeansDenoising()       # NLMç°éš
cv2.fastNlMeansDenoisingColored()  # NLMå½©è‰²
```

#### é–¾å€¼
```python
cv2.threshold()         # å›ºå®šé–¾å€¼
cv2.adaptiveThreshold() # è‡ªé©æ‡‰é–¾å€¼
```

---

## ğŸ’¡ å¯¦ç”¨æŠ€å·§

### 1. é™å™ªæµç¨‹
```python
# æ··åˆå™ªè²è™•ç†æµç¨‹
image_noisy = add_mixed_noise(image)
step1 = cv2.medianBlur(image_noisy, 5)      # ç§»é™¤æ¤’é¹½å™ªè²
step2 = cv2.bilateralFilter(step1, 9, 75, 75)  # ç§»é™¤é«˜æ–¯å™ªè²
result = cv2.fastNlMeansDenoising(step2, None, 10, 7, 21)  # æ·±åº¦é™å™ª
```

### 2. é‚Šç·£æª¢æ¸¬å„ªåŒ–
```python
# é‚Šç·£æª¢æ¸¬å‰çš„é è™•ç†
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
blurred = cv2.GaussianBlur(gray, (5, 5), 0)  # é™å™ª
edges = cv2.Canny(blurred, 50, 150)  # é‚Šç·£æª¢æ¸¬
```

### 3. ç›´æ–¹åœ–å‡åŒ–
```python
# å½©è‰²å½±åƒCLAHE
clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8, 8))
lab = cv2.cvtColor(image, cv2.COLOR_BGR2LAB)
lab[:, :, 0] = clahe.apply(lab[:, :, 0])  # åƒ…è™•ç†äº®åº¦é€šé“
result = cv2.cvtColor(lab, cv2.COLOR_LAB2BGR)
```

---

## ğŸ“ å¯¦æˆ°æ‡‰ç”¨

### æ‡‰ç”¨å ´æ™¯

| æŠ€è¡“ | æ‡‰ç”¨å ´æ™¯ | æ•ˆæœ |
|------|---------|------|
| **é«˜æ–¯æ¿¾æ³¢** | å¹³æ»‘å½±åƒã€å»é™¤é«˜é »å™ªè² | æ¨¡ç³Šä½†ä¿ç•™å¤§è‡´è¼ªå»“ |
| **ä¸­å€¼æ¿¾æ³¢** | å»é™¤æ¤’é¹½å™ªè² | ä¿ç•™é‚Šç·£ç´°ç¯€ |
| **å½¢æ…‹å­¸** | å»é™¤å°é›œé»ã€é€£æ¥æ–·è£‚ | æ”¹å–„çµæ§‹ |
| **Canny** | ç‰©é«”é‚Šç•Œæª¢æ¸¬ | æ¸…æ™°é‚Šç·£ |
| **CLAHE** | ä½å°æ¯”åº¦å½±åƒå¢å¼· | æå‡ç´°ç¯€å¯è¦‹åº¦ |
| **NLM** | ä¿é‚Šé™å™ª | é«˜å“è³ªé™å™ª |

### å…¸å‹å·¥ä½œæµç¨‹

```
åŸå§‹å½±åƒ
   â†“
é™å™ªè™•ç† (Bilateral/NLM)
   â†“
å°æ¯”åº¦å¢å¼· (CLAHE)
   â†“
é‚Šç·£æª¢æ¸¬ (Canny)
   â†“
å½¢æ…‹å­¸è™•ç† (Opening/Closing)
   â†“
é–¾å€¼åˆ†å‰² (Adaptive Threshold)
   â†“
è¼ªå»“åˆ†æ (findContours)
```

---

## ğŸ“ˆ æ•ˆèƒ½åŸºæº–

### å…¸å‹æ“ä½œè€—æ™‚ (512x512å½±åƒ)

| æ“ä½œ | æ™‚é–“ (ms) | é€Ÿåº¦ç­‰ç´š |
|------|-----------|----------|
| Gaussian Blur (5x5) | ~2-3 | âš¡âš¡âš¡âš¡âš¡ |
| Median Blur (5x5) | ~5-8 | âš¡âš¡âš¡âš¡ |
| Bilateral Filter | ~15-20 | âš¡âš¡âš¡ |
| Canny Edge | ~5-10 | âš¡âš¡âš¡âš¡ |
| CLAHE | ~10-15 | âš¡âš¡âš¡âš¡ |
| NLM Denoising | ~100-200 | âš¡ |

> æ¸¬è©¦ç’°å¢ƒ: CPUè™•ç†, ç„¡GPUåŠ é€Ÿ

---

## âœ… é‡Œç¨‹ç¢‘æª¢æŸ¥

- [âœ…] æ‰€æœ‰ç®—æ³•ç¯„ä¾‹å¯åŸ·è¡Œ
- [âœ…] å‰è™•ç†æ•ˆæœæ˜é¡¯
- [âœ…] æ•ˆèƒ½åŸºæº–æ¸¬è©¦é€šé
- [âœ…] å¯¦æˆ°æ‡‰ç”¨æ¡ˆä¾‹å®Œæ•´
- [âœ…] æ–‡æª”èªªæ˜æ¸…æ™°

**éšæ®µä¸‰ç‹€æ…‹**: âœ… **100%å®Œæˆ**

---

## ğŸ“– åƒè€ƒè³‡æº

- [OpenCV Image Filtering](https://docs.opencv.org/4.x/d4/d86/group__imgproc__filter.html)
- [OpenCV Morphological Operations](https://docs.opencv.org/4.x/d9/d61/tutorial_py_morphological_ops.html)
- [OpenCV Edge Detection](https://docs.opencv.org/4.x/da/d22/tutorial_py_canny.html)
- [OpenCV Histograms](https://docs.opencv.org/4.x/d1/db7/tutorial_py_histogram_begins.html)
- [OpenCV Denoising](https://docs.opencv.org/4.x/d5/d69/tutorial_py_non_local_means.html)

---

## ğŸš€ ä¸‹ä¸€æ­¥

å®Œæˆéšæ®µä¸‰å¾Œï¼Œå»ºè­°é€²å…¥ï¼š

**éšæ®µå››ï¼šç‰¹å¾µæª¢æ¸¬æ¨¡çµ„** (`04_feature_detection/`)
- è§’é»æª¢æ¸¬ (Harris, Shi-Tomasi, FAST)
- ç‰¹å¾µæè¿°å­ (SIFT, ORB, BRISK)
- ç‰¹å¾µåŒ¹é…èˆ‡è¿½è¹¤

---

**å»ºç«‹æ—¥æœŸ**: 2024-10-13
**ç¶­è­·è€…**: OpenCV Toolkit Team
**ç‰ˆæœ¬**: v1.0
**ç‹€æ…‹**: âœ… å®Œæˆ
